<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.xy.dao.TypeDao">

    <select id="getTypeName" parameterType="int"
            resultType="java.lang.String">
        SELECT type_name
        FROM goods_type
        WHERE type_id = #{typeId}
    </select>

    <insert id="addGoodsType">
        insert into goods_type(type_name,type_status)
        values(#{type_name},'active')
    </insert>

    <select id="getTypeByOperatorId" resultType="cn.xy.bean.GoodsType">
        select gt.type_id,gt.type_name,gt.type_status
        from goods_type as gt,operator_goodstype as og
        where gt.type_id=og.type_id and og.operator_id = #{operator_id} and gt.type_status = "active"
    </select>

    <select id="getOtherType" resultType="cn.xy.bean.GoodsType">
        select goods_type.type_id,type_name,type_status
        from goods_type
        left join operator_goodstype
        on goods_type.type_id=operator_goodstype.type_id
        where operator_id is null and type_status = "active"
    </select>

    <delete id="delOperatorGoodsType">
        delete from operator_goodstype
        where operator_id=#{operator_id} and type_id=#{type_id}
    </delete>

    <insert id="addOperatorGoodsType">
        insert into operator_goodstype(operator_id,type_id)
        values(#{operator_id},#{type_id})
    </insert>

</mapper>